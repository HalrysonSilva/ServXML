object Datamodule1: TDatamodule1
  OldCreateOrder = False
  OnCreate = DataModuleCreate
  Height = 703
  Width = 1109
  object ConDados: TUniConnection
    ProviderName = 'SQL Server'
    Port = 1433
    Database = 'Servsic'
    Username = 'sa'
    Server = '.\base'
    ConnectDialog = UniConnectDialog1
    LoginPrompt = False
    Left = 24
    Top = 24
    EncryptedPassword = 'CEFFCDFFCCFF'
  end
  object UniSQLMonitor1: TUniSQLMonitor
    Left = 24
    Top = 144
  end
  object SQLServerUniProvider1: TSQLServerUniProvider
    Left = 16
    Top = 208
  end
  object UniConnectDialog1: TUniConnectDialog
    DatabaseLabel = 'Database'
    PortLabel = 'Port'
    ProviderLabel = 'Provider'
    Caption = 'Connect'
    UsernameLabel = 'User Name'
    PasswordLabel = 'Password'
    ServerLabel = 'Server'
    ConnectButton = 'Connect'
    CancelButton = 'Cancel'
    Left = 24
    Top = 80
  end
  object QRYEMITENTE: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      'SELECT * FROM NFE_EMITENTE')
    Left = 168
    Top = 16
  end
  object DSQRYEMITENTE: TDataSource
    DataSet = QRYEMITENTE
    Left = 168
    Top = 64
  end
  object QRYBUSCAXML: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      'SELECT'
      '    x.codnota, '
      '    x.codemitente, '
      '    x.data_emissao, '
      '    x.numnota AS Num_Nota_Fiscal, '
      '    x.serie AS Serie, '
      '    x.pedido, '
      '    x.status, '
      '    x.xmlchave, '
      '    C.Valor_Total_Nota AS Valor, -- Coluna da NFE_CAB [cite: 1]'
      '    x.Tipo_Amb, '
      '    x.Num_Mod_Doc '
      'FROM'
      '    nfe_xml x'
      
        '-- Une NFE_XML (x) com NFE_CAB (C) pelo CodNota e CodEmitente [c' +
        'ite: 1642]'
      'JOIN '
      
        '    NFE_CAB C ON C.CodNota = x.CodNota AND C.CodEmitente = x.Cod' +
        'Emitente '
      'WHERE'
      '    x.Data_Emissao BETWEEN :DataInicio AND :DataFim -- '
      '  AND '
      
        '    x.Status = '#39'T'#39' -- Filtra apenas registros que foram transmit' +
        'idos/autorizados '
      '  AND '
      
        '    (x.XMLTransmissao LIKE '#39'%<cStat>100</cStat>%'#39' OR x.XMLTransm' +
        'issao LIKE '#39'%<cStat>150</cStat>%'#39') -- Filtro de autoriza'#231#227'o/dene' +
        'ga'#231#227'o '
      '  AND '
      
        '    x.CodEmitente = :CodEmitente -- Filtro obrigat'#243'rio de emiten' +
        'te [cite: 1546]'
      '  AND '
      '    x.Tipo_Amb = 1 -- Tipo Ambiente fixo em 1 (Produ'#231#227'o) '
      
        '-- As cl'#225'usulas abaixo s'#227'o adicionadas dinamicamente se o usu'#225'ri' +
        'o selecionou filtros de modelo e s'#233'rie:'
      '/*'
      '  AND x.Num_Mod_Doc = :Modelo'
      '  AND x.Serie = :Serie'
      '*/'
      'ORDER BY '
      '    x.NumNota')
    Left = 168
    Top = 136
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'DataInicio'
        Value = Null
      end
      item
        DataType = ftUnknown
        Name = 'DataFim'
        Value = Null
      end
      item
        DataType = ftUnknown
        Name = 'CodEmitente'
        Value = Null
      end>
    object QRYBUSCAXMLcodnota: TIntegerField
      FieldName = 'codnota'
      Required = True
    end
    object QRYBUSCAXMLcodemitente: TIntegerField
      FieldName = 'codemitente'
    end
    object QRYBUSCAXMLdata_emissao: TDateTimeField
      FieldName = 'data_emissao'
    end
    object QRYBUSCAXMLNum_Nota_Fiscal: TIntegerField
      FieldName = 'Num_Nota_Fiscal'
    end
    object QRYBUSCAXMLSerie: TStringField
      FieldName = 'Serie'
      FixedChar = True
      Size = 1
    end
    object QRYBUSCAXMLpedido: TIntegerField
      FieldName = 'pedido'
    end
    object QRYBUSCAXMLstatus: TStringField
      FieldName = 'status'
      Size = 10
    end
    object QRYBUSCAXMLxmlchave: TStringField
      FieldName = 'xmlchave'
      Size = 44
    end
    object QRYBUSCAXMLValor: TFloatField
      FieldName = 'Valor'
      ReadOnly = True
    end
    object QRYBUSCAXMLTipo_Amb: TIntegerField
      FieldName = 'Tipo_Amb'
    end
    object QRYBUSCAXMLNum_Mod_Doc: TIntegerField
      FieldName = 'Num_Mod_Doc'
    end
  end
  object DSQRYBUSCAXML: TDataSource
    DataSet = QRYBUSCAXML
    Left = 160
    Top = 208
  end
  object QRYTIPONOTA: TUniQuery
    Connection = ConDados
    Left = 160
    Top = 264
  end
  object QRYEMAILLOG: TUniQuery
    Connection = ConDados
    Left = 168
    Top = 328
  end
  object QRYSERIE: TUniQuery
    Connection = ConDados
    Left = 168
    Top = 408
  end
  object QRYCRIATABSERVXML: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      '-- Parte 1: Cria a tabela SERVXML se ela n'#227'o existir'
      
        'IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TAB' +
        'LE_NAME = '#39'SERVXML'#39')'
      'BEGIN'
      '    CREATE TABLE SERVXML ('
      '        Controle INT IDENTITY(1,1) PRIMARY KEY,'
      '        CodNota INT NOT NULL,'
      '        CodEmitente INT NOT NULL,'
      '        NumNota INT NOT NULL,'
      '        Num_Mod_Doc INT NOT NULL,'
      '        Serie CHAR(10) COLLATE Latin1_General_CI_AS NOT NULL,'
      
        '        XMLTransmissao TEXT COLLATE Latin1_General_100_CI_AS, --' +
        ' Ajustado para compatibilidade'
      '        Data_emissao DATETIME DEFAULT GETDATE(),'
      '        Status CHAR(1) COLLATE Latin1_General_CI_AS'
      '    );'
      'END;'
      ''
      ''
      ''
      ''
      ''
      '')
    Left = 48
    Top = 272
  end
  object QRYINSERESERVXML: TUniQuery
    Connection = ConDados
    Left = 272
    Top = 32
  end
  object QRYVERIFICASERVXML: TUniQuery
    Connection = ConDados
    Left = 272
    Top = 88
  end
  object QRYBUSCARVALOR: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      'SELECT SUM(NFE_CAB.Valor_Total_Nota) AS ValorTotalEmitido'
      'FROM NFE_CAB'
      'INNER JOIN NFE_XML ON NFE_CAB.Num_Nota_Fiscal = NFE_XML.NumNota'
      'WHERE NFE_CAB.CodEmitente = :CodEmitente'
      
        'AND CAST(NFE_CAB.Data_Emissao AS DATE) BETWEEN :DataInicio AND :' +
        'DataFim'
      'AND NFE_XML.Status = '#39'T'#39
      
        'AND NFE_CAB.CFOP IN ('#39'5101'#39', '#39'5102'#39', '#39'5405'#39', '#39'6101'#39', '#39'6102'#39', '#39'64' +
        '05'#39');')
    Left = 272
    Top = 152
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'CodEmitente'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'DataInicio'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'DataFim'
        Value = nil
      end>
  end
  object QRYBUSCARNOTAS: TUniQuery
    Connection = ConDados
    Left = 272
    Top = 208
  end
  object DSQRYBUSCARNOTAS: TDataSource
    DataSet = QRYBUSCARNOTAS
    Left = 272
    Top = 264
  end
  object QRYADDTAREFA: TUniQuery
    Connection = ConDados
    Left = 400
    Top = 24
  end
  object QRYSALVAARQXML: TUniQuery
    Connection = ConDados
    Left = 280
    Top = 320
  end
  object QRYVERIFICAINUTILIZACAO: TUniQuery
    Connection = ConDados
    Left = 272
    Top = 376
  end
  object QRYVERIFICANFE_XML: TUniQuery
    Connection = ConDados
    Left = 264
    Top = 440
  end
  object QRYBUSCANTSALVARNFE_XML: TUniQuery
    Connection = ConDados
    Left = 272
    Top = 504
  end
  object QRYBUSCANTSALVARSERVXML: TUniQuery
    Connection = ConDados
    Left = 256
    Top = 576
  end
  object QRYTOTALEMITIDO: TUniQuery
    Connection = ConDados
    Left = 520
    Top = 144
  end
  object QRYBUSCARSALVADORES: TUniQuery
    Connection = ConDados
    Left = 392
    Top = 96
  end
  object QRYXMLNFeInutilizada: TUniQuery
    Connection = ConDados
    Left = 392
    Top = 160
  end
  object QRYXMLNFeCab: TUniQuery
    Connection = ConDados
    Left = 400
    Top = 232
  end
  object QRYXMLNFCeCab: TUniQuery
    Connection = ConDados
    Left = 400
    Top = 312
  end
  object QRYXMLCanceladas: TUniQuery
    Connection = ConDados
    Left = 400
    Top = 560
  end
  object QRYNOTASRECEBIDAS: TUniQuery
    Connection = ConDados
    Left = 536
    Top = 24
  end
  object DsQRYNOTASRECEBIDAS: TDataSource
    DataSet = QRYNOTASRECEBIDAS
    Left = 536
    Top = 72
  end
  object QRYNOTAPERDIDA: TUniQuery
    Connection = ConDados
    Left = 792
    Top = 24
  end
  object DSQRYNOTAPERDIDA: TDataSource
    DataSet = QRYNOTAPERDIDA
    Left = 792
    Top = 80
  end
  object QRYCORRIGEDADOS: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      '-- ************************************************************'
      
        '-- CORRE'#199#195'O DA ESTRUTURA PARA NFE_XML (CLIENTES) - Vers'#227'o Corrig' +
        'ida'
      '-- ************************************************************'
      ''
      '-- 1. CFOP: Garante que a coluna CFOP esteja presente (INT)'
      'IF NOT EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      '    WHERE name = '#39'CFOP'#39' AND object_id = OBJECT_ID('#39'dbo.NFE_XML'#39')'
      ')'
      'BEGIN'
      '    ALTER TABLE dbo.NFE_XML ADD CFOP INT NULL;'
      'END;'
      ''
      '-- 2. RejeicaoMotivo: Ajusta o tamanho para VARCHAR(255)'
      'IF EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'RejeicaoMotivo'#39' AND object_id = OBJECT_ID('#39'dbo' +
        '.NFE_XML'#39')'
      ')'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ALTER COLUMN RejeicaoMotivo VARCHAR(' +
        '255) NULL;'
      'END'
      'ELSE'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ADD RejeicaoMotivo VARCHAR(255) NULL' +
        ';'
      'END;'
      ''
      
        '-- 3. AJUSTES DE TIPO DE DADOS (TEXT para VARCHAR(MAX) ou NVARCH' +
        'AR(MAX))'
      ''
      '-- 3.1. XMLGeracao - de TEXT/VARCHAR(MAX) para NVARCHAR(MAX)'
      
        '-- NOTA: O bloco abaixo verifica se a coluna existe antes de ten' +
        'tar alter'#225'-la.'
      'IF EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'XMLGeracao'#39' AND object_id = OBJECT_ID('#39'dbo.NFE' +
        '_XML'#39')'
      ')'
      'BEGIN'
      
        '    -- Se a coluna j'#225' existir, tenta alterar o tipo, se necess'#225'r' +
        'io'
      
        '    ALTER TABLE dbo.NFE_XML ALTER COLUMN XMLGeracao NVARCHAR(MAX' +
        ') NULL;'
      'END'
      'ELSE'
      'BEGIN'
      '    -- Se a coluna n'#227'o existir, cria-a como NVARCHAR(MAX)'
      '    ALTER TABLE dbo.NFE_XML ADD XMLGeracao NVARCHAR(MAX) NULL;'
      'END;'
      ''
      '-- 3.2. XMLTransmissao - de TEXT/VARCHAR(MAX) para NVARCHAR(MAX)'
      'IF EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'XMLTransmissao'#39' AND object_id = OBJECT_ID('#39'dbo' +
        '.NFE_XML'#39')'
      ')'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ALTER COLUMN XMLTransmissao NVARCHAR' +
        '(MAX) NULL;'
      'END'
      'ELSE'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ADD XMLTransmissao NVARCHAR(MAX) NUL' +
        'L;'
      'END;'
      ''
      
        '-- 3.3. XMLCancelamento - de TEXT/VARCHAR(MAX) para NVARCHAR(MAX' +
        ')'
      'IF EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'XMLCancelamento'#39' AND object_id = OBJECT_ID('#39'db' +
        'o.NFE_XML'#39')'
      ')'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ALTER COLUMN XMLCancelamento NVARCHA' +
        'R(MAX) NULL;'
      'END'
      'ELSE'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ADD XMLCancelamento NVARCHAR(MAX) NU' +
        'LL;'
      'END;'
      ''
      '-- 3.4. XMLInutilizacao - de TEXT/VARCHAR para VARCHAR(MAX)'
      'IF EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'XMLInutilizacao'#39' AND object_id = OBJECT_ID('#39'db' +
        'o.NFE_XML'#39')'
      ')'
      'BEGIN'
      '    -- Mantido como VARCHAR(MAX) conforme sua estrutura'
      
        '    ALTER TABLE dbo.NFE_XML ALTER COLUMN XMLInutilizacao VARCHAR' +
        '(MAX) NULL;'
      'END'
      'ELSE'
      'BEGIN'
      
        '    ALTER TABLE dbo.NFE_XML ADD XMLInutilizacao VARCHAR(MAX) NUL' +
        'L;'
      'END;'
      ''
      ''
      '-- 4. CRIA'#199#195'O DA COLUNA '#39'chavecorreta'#39' (NOVO REQUISITO)'
      'IF NOT EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'chavecorreta'#39' AND object_id = OBJECT_ID('#39'dbo.N' +
        'FE_XML'#39')'
      ')'
      'BEGIN'
      '    ALTER TABLE dbo.NFE_XML ADD chavecorreta VARCHAR(44) NULL;'
      'END;'
      ''
      ''
      '-- 5. CRIA'#199#195'O DE COLUNAS AUSENTES'
      ''
      '-- 5.1. ST_Retorno (INT)'
      'IF NOT EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'ST_Retorno'#39' AND object_id = OBJECT_ID('#39'dbo.NFE' +
        '_XML'#39')'
      ')'
      'BEGIN'
      '    ALTER TABLE dbo.NFE_XML ADD ST_Retorno INT NULL;'
      'END;'
      ''
      '-- 5.2. Data_Rejeicao (DATETIME)'
      'IF NOT EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'Data_Rejeicao'#39' AND object_id = OBJECT_ID('#39'dbo.' +
        'NFE_XML'#39')'
      ')'
      'BEGIN'
      '    ALTER TABLE dbo.NFE_XML ADD Data_Rejeicao DATETIME NULL;'
      'END;'
      ''
      '-- 5.3. Rejeicao (VARCHAR(MAX))'
      'IF NOT EXISTS ('
      '    SELECT 1'
      '    FROM sys.columns '
      
        '    WHERE name = '#39'Rejeicao'#39' AND object_id = OBJECT_ID('#39'dbo.NFE_X' +
        'ML'#39')'
      ')'
      'BEGIN'
      '    ALTER TABLE dbo.NFE_XML ADD Rejeicao VARCHAR(MAX) NULL;'
      'END;'
      ''
      '-- ************************************************************'
      '-- FIM DAS CORRE'#199#213'ES NA TABELA NFE_XML'
      '-- ************************************************************')
    Left = 48
    Top = 336
  end
  object QRYVENDASPENDENTES: TUniQuery
    Connection = ConDados
    Left = 792
    Top = 152
  end
  object DSVENDASPENDENTES: TDataSource
    DataSet = QRYVENDASPENDENTES
    Left = 792
    Top = 208
  end
  object QRYLIMPANFCE: TUniQuery
    Connection = ConDados
    Left = 792
    Top = 272
  end
  object QRYBUSCAULTIMANFCE: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      'SELECT'
      '    MAX(NumNota) AS Registro'
      'FROM'
      '    NFE_XML'
      'WHERE'
      '    Serie = :serie'
      '    AND Num_Mod_Doc = 65'
      '    AND Status = '#39'T'#39)
    Left = 792
    Top = 328
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'serie'
        Value = Null
      end>
  end
  object QRYNOVONUMNFCEMANUAL: TUniQuery
    Connection = ConDados
    Left = 784
    Top = 408
  end
  object DSSequencia: TDataSource
    DataSet = QRYSequencia
    Left = 896
    Top = 328
  end
  object QRYSequencia: TUniQuery
    Connection = ConDados
    Left = 888
    Top = 256
  end
  object QRYupdatebanco: TUniQuery
    Connection = ConDados
    SQL.Strings = (
      '-- 1. ATUALIZAR CodEmitente'
      'UPDATE N_XML'
      'SET'
      '    N_XML.CodEmitente = C.CodEmitente'
      'FROM'
      '    NFE_XML N_XML'
      'INNER JOIN'
      '    NFE_CAB C ON N_XML.NumNota = C.Num_Nota_Fiscal'
      'WHERE'
      
        '    N_XML.CodEmitente IS NULL; -- Filtra apenas registros onde a' +
        ' coluna est'#225' vazia'
      ''
      ''
      '-- 2. ATUALIZAR Num_Mod_Doc'
      'UPDATE N_XML'
      'SET'
      '    N_XML.Num_Mod_Doc = C.Num_Mod_Doc'
      'FROM'
      '    NFE_XML N_XML'
      'INNER JOIN'
      
        '    NFE_CAB C ON N_XML.NumNota = C.Num_Nota_Fiscal AND N_XML.Cod' +
        'Emitente = C.CodEmitente'
      'WHERE'
      '    N_XML.Num_Mod_Doc IS NULL OR N_XML.Num_Mod_Doc = 0;'
      ''
      ''
      '-- 3. ATUALIZAR VALOR (Corre'#231#227'o Cr'#237'tica)'
      'UPDATE N_XML'
      'SET'
      '    N_XML.Valor = C.Valor_Total_Nota'
      'FROM'
      '    NFE_XML N_XML'
      'INNER JOIN'
      '    NFE_CAB C ON N_XML.NumNota = C.Num_Nota_Fiscal '
      '                 AND N_XML.Serie = C.Num_Serie'
      '                 AND N_XML.Num_Mod_Doc = C.Num_Mod_Doc'
      '                 AND N_XML.CodEmitente = C.CodEmitente;'
      
        '-- N'#227'o '#233' necess'#225'rio WHERE EXISTS, pois o INNER JOIN j'#225' garante a' +
        ' correspond'#234'ncia.'
      ''
      ''
      '-- 4. ATUALIZAR CFOP'
      'UPDATE N_XML'
      'SET'
      '    N_XML.CFOP = C.CFOP'
      'FROM'
      '    NFE_XML N_XML'
      'INNER JOIN'
      '    NFE_CAB C ON N_XML.NumNota = C.Num_Nota_Fiscal '
      '                 AND N_XML.Serie = C.Num_Serie'
      '                 AND N_XML.Num_Mod_Doc = C.Num_Mod_Doc'
      '                 AND N_XML.CodEmitente = C.CodEmitente'
      'WHERE'
      '    N_XML.CFOP IS NULL OR N_XML.CFOP = 0;')
    Left = 40
    Top = 400
  end
  object frxReportNotas: TfrxReport
    Version = '6.4.13'
    DotMatrixReport = False
    IniFile = '\Software\Fast Reports'
    PreviewOptions.Buttons = [pbPrint, pbLoad, pbSave, pbExport, pbZoom, pbFind, pbOutline, pbPageSetup, pbTools, pbEdit, pbNavigator, pbExportQuick, pbCopy, pbSelection]
    PreviewOptions.Zoom = 1.000000000000000000
    PrintOptions.Printer = 'Padr'#227'o'
    PrintOptions.PrintOnSheet = 0
    ReportOptions.CreateDate = 45904.715523645800000000
    ReportOptions.LastChange = 45960.512685671300000000
    ScriptLanguage = 'PascalScript'
    ScriptText.Strings = (
      'begin'
      ''
      'end.')
    Left = 888
    Top = 512
    Datasets = <
      item
        DataSet = frxdsNotas
        DataSetName = 'frxDBDataset1'
      end>
    Variables = <>
    Style = <>
    object Data: TfrxDataPage
      Height = 1000.000000000000000000
      Width = 1000.000000000000000000
    end
    object Page1: TfrxReportPage
      PaperWidth = 210.000000000000000000
      PaperHeight = 297.000000000000000000
      PaperSize = 9
      LeftMargin = 10.000000000000000000
      RightMargin = 10.000000000000000000
      TopMargin = 10.000000000000000000
      BottomMargin = 10.000000000000000000
      Frame.Typ = []
      MirrorMode = []
      object ReportTitle1: TfrxReportTitle
        FillType = ftBrush
        Frame.Typ = []
        Height = 37.795300000000000000
        Top = 18.897650000000000000
        Width = 718.110700000000000000
        object Memo1: TfrxMemoView
          Align = baClient
          AllowVectorExport = True
          Width = 718.110700000000000000
          Height = 37.795300000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clWhite
          Font.Height = -27
          Font.Name = 'Segoe UI'
          Font.Style = [fsBold]
          Frame.Typ = []
          Fill.BackColor = clWindowFrame
          HAlign = haCenter
          Memo.UTF8W = (
            'Rela'#231#227'o de Documentos Fiscais')
          ParentFont = False
        end
      end
      object MasterData1: TfrxMasterData
        FillType = ftBrush
        Frame.Typ = []
        Height = 26.456710000000000000
        Top = 117.165430000000000000
        Width = 718.110700000000000000
        DataSet = frxdsNotas
        DataSetName = 'frxDBDataset1'
        RowCount = 0
        object Memo2: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Width = 113.385900000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Data')
          ParentFont = False
        end
        object Memo6: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Left = 113.385900000000000000
          Width = 75.590600000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Chave')
          ParentFont = False
        end
      end
      object DetailData1: TfrxDetailData
        FillType = ftBrush
        Frame.Typ = []
        Height = 56.692950000000000000
        Top = 166.299320000000000000
        Width = 718.110700000000000000
        DataSet = frxdsNotas
        DataSetName = 'frxDBDataset1'
        RowCount = 0
        object frxDBDataset1data_emissao: TfrxMemoView
          IndexTag = 1
          Align = baLeft
          AllowVectorExport = True
          Top = 3.779530000000000000
          Width = 113.385900000000000000
          Height = 18.897650000000000000
          DataField = 'data_emissao'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."data_emissao"]')
          ParentFont = False
        end
        object frxDBDataset1Num_Nota_Fiscal: TfrxMemoView
          IndexTag = 1
          Align = baLeft
          AllowVectorExport = True
          Left = 41.574830000000000000
          Top = 30.236240000000000000
          Width = 147.401670000000000000
          Height = 18.897650000000000000
          DataField = 'Num_Nota_Fiscal'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."Num_Nota_Fiscal"]')
          ParentFont = False
        end
        object frxDBDataset1Serie: TfrxMemoView
          IndexTag = 1
          Align = baLeft
          AllowVectorExport = True
          Left = 226.771800000000000000
          Top = 30.236240000000000000
          Width = 113.385900000000000000
          Height = 18.897650000000000000
          DataField = 'Serie'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."Serie"]')
          ParentFont = False
        end
        object frxDBDataset1Num_Mod_Doc: TfrxMemoView
          IndexTag = 1
          Align = baLeft
          AllowVectorExport = True
          Left = 393.071120000000000000
          Top = 30.236240000000000000
          Width = 136.063080000000000000
          Height = 18.897650000000000000
          DataField = 'Num_Mod_Doc'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."Num_Mod_Doc"]')
          ParentFont = False
        end
        object frxDBDataset1xmlchave: TfrxMemoView
          IndexTag = 1
          Align = baWidth
          AllowVectorExport = True
          Left = 113.385900000000000000
          Top = 3.779530000000000000
          Width = 604.724800000000000000
          Height = 18.897650000000000000
          DataField = 'xmlchave'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."xmlchave"]')
          ParentFont = False
        end
        object frxDBDataset1Valor: TfrxMemoView
          IndexTag = 1
          Align = baLeft
          AllowVectorExport = True
          Left = 570.709030000000000000
          Top = 30.236240000000000000
          Width = 105.826840000000000000
          Height = 18.897650000000000000
          DataField = 'Valor'
          DataSet = frxdsNotas
          DataSetName = 'frxDBDataset1'
          DisplayFormat.FormatStr = '%2.2m'
          DisplayFormat.Kind = fkNumeric
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            '[frxDBDataset1."Valor"]')
          ParentFont = False
        end
        object Memo3: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Top = 30.236240000000000000
          Width = 41.574830000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Nota:')
          ParentFont = False
        end
        object Memo4: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Left = 188.976500000000000000
          Top = 30.236240000000000000
          Width = 37.795300000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Serie:')
          ParentFont = False
        end
        object Memo5: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Left = 340.157700000000000000
          Top = 30.236240000000000000
          Width = 52.913420000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Modelo:')
          ParentFont = False
        end
        object Memo7: TfrxMemoView
          Align = baLeft
          AllowVectorExport = True
          Left = 529.134200000000000000
          Top = 30.236240000000000000
          Width = 41.574830000000000000
          Height = 18.897650000000000000
          Font.Charset = ANSI_CHARSET
          Font.Color = clBlack
          Font.Height = -13
          Font.Name = 'Segoe UI Semibold'
          Font.Style = [fsBold]
          Frame.Typ = []
          Memo.UTF8W = (
            'Valor:')
          ParentFont = False
        end
      end
    end
  end
  object frxdsNotas: TfrxDBDataset
    UserName = 'frxDBDataset1'
    CloseDataSource = False
    FieldAliases.Strings = (
      'codnota=codnota'
      'codemitente=codemitente'
      'data_emissao=data_emissao'
      'Num_Nota_Fiscal=Num_Nota_Fiscal'
      'Serie=Serie'
      'pedido=pedido'
      'status=status'
      'xmlchave=xmlchave'
      'Valor=Valor'
      'Tipo_Amb=Tipo_Amb'
      'Num_Mod_Doc=Num_Mod_Doc')
    DataSource = DSQRYBUSCAXML
    BCDToCurrency = False
    Left = 888
    Top = 576
  end
  object QRYVERITABEST3A: TUniQuery
    Connection = ConDados
    Left = 784
    Top = 472
  end
  object QRYPSQPENDENTE: TUniQuery
    Connection = ConDados
    Left = 536
    Top = 240
  end
  object QRYTOTALPENDENTE: TUniQuery
    Connection = ConDados
    Left = 536
    Top = 360
  end
  object DSQRYPSQPENDENTE: TDataSource
    Left = 536
    Top = 296
  end
  object DSQRYTOTALPENDENTE: TDataSource
    Left = 536
    Top = 424
  end
  object QRYSALVAENVIO: TUniQuery
    Connection = ConDados
    Left = 536
    Top = 488
  end
  object QRYDELETENFEINUT: TUniQuery
    Connection = ConDados
    Left = 408
    Top = 376
  end
  object CDSCONSULTACHAVE: TClientDataSet
    Aggregates = <>
    Params = <>
    Left = 656
    Top = 192
  end
  object QRYNUMNOTASEFAZ: TUniQuery
    Connection = ConDados
    Left = 656
    Top = 112
  end
  object DSCDSCONSULTACHAVE: TDataSource
    DataSet = CDSCONSULTACHAVE
    Left = 656
    Top = 256
  end
  object QRYCORRIGEPENDENCIA: TUniQuery
    Connection = ConDados
    Left = 56
    Top = 472
  end
  object QRYCARREGAVENDAS: TUniQuery
    Connection = ConDados
    Left = 648
    Top = 328
  end
  object DSQRYCARREGAVENDAS: TDataSource
    DataSet = QRYCARREGAVENDAS
    Left = 648
    Top = 384
  end
  object QRYMIGRAR_XMLTEMP: TUniQuery
    Connection = ConDados
    Left = 784
    Top = 536
  end
  object QRYCHAVEDIFERENTE: TUniQuery
    Connection = ConDados
    Left = 656
    Top = 552
  end
  object QRYATUALIZACHAVE: TUniQuery
    Connection = ConDados
    Left = 656
    Top = 496
  end
  object DSCDSCHAVESCORRETAS: TDataSource
    DataSet = CDSCHAVESCORRETAS
    Left = 984
    Top = 80
  end
  object CDSCHAVESCORRETAS: TClientDataSet
    Aggregates = <>
    Params = <>
    Left = 984
    Top = 24
    object CDSCHAVESCORRETASCODNOTA: TIntegerField
      FieldName = 'CODNOTA'
    end
    object CDSCHAVESCORRETASANTIGACHAVE: TStringField
      FieldName = 'ANTIGACHAVE'
    end
    object CDSCHAVESCORRETASNOVACHAVE: TStringField
      FieldName = 'NOVACHAVE'
    end
    object CDSCHAVESCORRETASCODEMITENTE: TIntegerField
      FieldName = 'CODEMITENTE'
    end
    object CDSCHAVESCORRETASNUMNOTA: TStringField
      FieldName = 'NUMNOTA'
    end
    object CDSCHAVESCORRETASserie: TStringField
      FieldName = 'serie'
    end
  end
  object QRYNAOUSADOSPORDATA: TUniQuery
    Connection = ConDados
    Left = 408
    Top = 440
  end
  object QRYNCM: TUniQuery
    Connection = ConDados
    Left = 536
    Top = 552
  end
end
